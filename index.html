<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Flow</title>
  <style>
    :root {
      --bg-color: #0d1117;
      --text-color: #c9d1d9;
      --accent-color: #58a6ff;
      --button-bg: #21262d;
      --button-hover: #30363d;
    }

    body.light {
      --bg-color: #f4f4f4;
      --text-color: #1f2937;
      --accent-color: #2563eb;
      --button-bg: #e5e7eb;
      --button-hover: #d1d5db;
    }

    body {
      margin: 0;
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      flex-direction: column;
      text-align: center;
      padding: 16px;
      user-select: none;
      -webkit-user-select: none;
    }

    h1 {
      font-size: 4rem;
      margin: 0;
      color: white;
    }

    .button {
      padding: 12px 24px;
      margin: 8px;
      border: none;
      border-radius: 12px;
      background-color: var(--button-bg);
      color: var(--text-color);
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
    }

    .button:hover {
      background-color: var(--button-hover);
    }

    #game {
      display: none;
      width: 100%;
      max-width: 600px;
    }

    #currentWord {
      font-size: 2rem;
      letter-spacing: 0.2em;
    }

    .letter.correct {
      color: green;
    }

    .letter.wrong {
      color: red;
    }

    .themeToggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
    }

    #hint {
      opacity: 0;
      transition: opacity 0.5s ease;
      margin-top: 10px;
      font-size: 1rem;
      color: var(--accent-color);
    }

    #hint.show {
      opacity: 1;
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <h1 style="color: white;">Typing Flow</h1>
  <button class="button" id="tr">Türkçe</button>
  <button class="button" id="en">English</button>
  <div id="game">
    <p id="currentWord"></p>
    <p>Kelime Sayacı: <span id="counter">0</span></p>
    <p id="hint">Kelimeyi yazdıktan sonra boşluk tuşuna bas</p>
  </div>
  <button class="button themeToggle" id="themeToggle">Tema</button>
  <div id="nukeMessage">GÜVENLİK İHLALİ TESPİT EDİLDİ!</div>
  <script>
    (() => {
      let turkishWords = []
      let englishWords = []
      let currentWord = ""
      let wordList = []
      let buffer = ""
      let correctCount = 0
      let lang = "tr"
      let usedWords = []
      let idleTimeout
      const trBtn = document.getElementById("tr")
      const enBtn = document.getElementById("en")
      const themeToggle = document.getElementById("themeToggle")
      const currentWordEl = document.getElementById("currentWord")
      const counterEl = document.getElementById("counter")
      const game = document.getElementById("game")
      const hint = document.getElementById("hint")

      trBtn.onclick = () => {
        lang = "tr"
        wordList = turkishWords
        startGame()
      }

      enBtn.onclick = () => {
        lang = "en"
        wordList = englishWords
        startGame()
      }

      themeToggle.onclick = () => {
        document.body.classList.toggle("light")
      }

      function startGame() {
        if (wordList.length === 0) return alert("Kelime listesi yüklenemedi.")
        game.style.display = "block"
        correctCount = 0
        buffer = ""
        usedWords = []
        counterEl.textContent = correctCount
        nextWord()
      }

      function nextWord() {
        clearTimeout(idleTimeout)
        hint.classList.remove("show")
        if (usedWords.length >= wordList.length) usedWords = []
        do {
          currentWord = wordList[Math.floor(Math.random() * wordList.length)]
        } while (usedWords.includes(currentWord))
        usedWords.push(currentWord)
        renderWord()
        buffer = ""
        idleTimeout = setTimeout(() => {
          hint.classList.add("show")
        }, 5000)
      }

      function renderWord() {
        currentWordEl.innerHTML = ""
        for (let i = 0; i < currentWord.length; i++) {
          const span = document.createElement("span")
          span.textContent = currentWord[i]
          span.classList.add("letter")
          if (buffer[i]) {
            span.classList.add(buffer[i] === currentWord[i] ? "correct" : "wrong")
          }
          currentWordEl.appendChild(span)
        }
      }

      window.addEventListener("keydown", (e) => {
        if (game.style.display !== "block") return
        clearTimeout(idleTimeout)
        hint.classList.remove("show")
        if (e.key === " ") {
          e.preventDefault()
          if (buffer.trim() === currentWord) correctCount++
          counterEl.textContent = correctCount
          nextWord()
        } else if (/^[a-zA-ZçÇğĞıİöÖşŞüÜ]$/.test(e.key)) {
          buffer += e.key
          renderWord()
        } else if (e.key === "Backspace") {
          buffer = buffer.slice(0, -1)
          renderWord()
        }
      })

      async function loadWords() {
        try {
          const tr = await fetch('turkce.txt')
          const en = await fetch('english.txt')
          turkishWords = (await tr.text()).split('\n').map(w => w.trim()).filter(w => w)
          englishWords = (await en.text()).split('\n').map(w => w.trim()).filter(w => w)
        } catch (err) {
          console.error("Dosyalar yüklenemedi")
        }
      }

      loadWords()

      const n = () => {
        document.body.innerHTML = ''
        document.body.style.background = '#000'
        document.getElementById('nukeMessage').style.display = 'block'
        setInterval(() => location.reload(), 300)
      }

      const d = () => {
        const e = document.createElement('script')
        e.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js'
        e.onerror = n
        document.head.append(e)
      }

      const k = (e) => {
        const t = [
          e.ctrlKey && e.code === 'KeyI',
          e.ctrlKey && e.code === 'KeyJ',
          e.ctrlKey && e.shiftKey && e.code === 'KeyC',
          e.code === 'F12',
          e.metaKey && e.altKey && e.code === 'KeyI'
        ]
        if (t.some(t => t)) {
          e.preventDefault()
          e.stopImmediatePropagation()
          n()
        }
      }

      setInterval(() => {
        try {
          if (window.outerWidth - window.innerWidth > 160 || window.outerHeight - window.innerHeight > 160 ||
            document.documentElement.getAttribute('debug') ||
            document.documentElement.getAttribute('firebug')) throw n()
          new Function('debugger')()
          d()
        } catch (e) {
          n()
        }
      }, 200)

      document.addEventListener('keydown', k)
      document.addEventListener('contextmenu', e => e.preventDefault())
      window.console = { log: () => { }, warn: () => { }, error: () => { }, debug: () => { } }
    })()
  </script>
</body>
</html>
